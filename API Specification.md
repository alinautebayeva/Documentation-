# 1. Основная информация 



|                   |                                                                                                                                                                   |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Автор             | Алина                                                                                                                                                             |
| Задача            | Реализовать возможность бронировать переговорную комнату через мобильное приложение                                                                               |
| Бизнес-постановка | Пользователь (сотрудник компании) бронирует свободную переговорную комнату в приложении, вместо текущего процесса бронирования через запросы по электронной почте |

## 1.1 История изменений 

 | Версия | Дата       | Автор | Описание                        |
 | ------ | ---------- | ----- | ------------------------------- |
 | 1.1    | 10.01.2026 | Алина | Внесены корректировки
 | 1.0    | 20.12.2025 | Алина | Создана первая версия документа |


# 2. Авторизация запросов 
Авторизация запросов осуществляется с использованием токена доступа (accessToken). После успешной авторизации пользователь получает accessToken, который должен передаваться в заголовке HTTP в формате Bearer <token>. После истечения срока действия accessToken клиент обновляет его с помощью refreshToken.

# 3. Описание запросов и ответов

## 3.1 Вход пользователя в систему

__Метод:__ POST <br>
__URL:__ api/login <br>
__Content-Type:__ application/json

Тело запроса:

``` 
{
    "email": "ivanpetrov@example.com",
    "password": "example123!"
}
``` 
__Параметры запроса:__ 

 | Параметр | Тип    | Обязательный/Необязательный | Описание            |
 | -------- | ------ | --------------------------- | ------------------- |
 | email    | string | обязательный                | Email пользователя  |
 | password | string | обязательный                | Пароль пользователя |

### __Ответы:__ 

#### 1. 200 OK 

Тело ответа: 
```
{
  "accessToken": "asdfgh...",
  "refreshToken": "zcvb......",
  "user": {
    "userID": 12345,
    "email": "ivanpetrov@example.com",
    "firstname": "Иван",
    "lastname": "Петров"
  }
}
```

Параметры ответа: 
| Параметр      | Тип     | Описание                                                               |
|---------------|---------|------------------------------------------------------------------------|
| accessToken   | string  | Авторизация запросов к API. Срок действия - 15 минут                   |
| resfreshToken | string  | Обновление access token без повторного логина. Срок действия - 30 дней |
| userID        | integer | Идентификатор пользователя                                             |
| firstname     | string  | Имя пользователя                                                       |
| lastname      | string  | Фамилия пользователя                                                   |




#### 2. 401 Unauthorized 

Ошибка выдается в случае, если введены неверные email или пароль.

Тело ответа: 

```
{
  "message": "Invalid email or password"
}
```

#### 3. 400 Bad Request
Ошибка выдается, если пользователь не ввел email или пароль.

Пример тела ответа: 
```
{
 "message": "Email is required"
}
```
## 3.2 Получение списка переговорных комнат 
Метод возвращает список переговорных комнат, доступных в системе.
Может использоваться для отображения списка комнат и фильтрации по параметрам (этаж, вместимость, наличие проектора).

__Метод:__ GET <br>
__URL:__ api/rooms <br>
__Content-Type:__ application/json <br>
Authorization: Bearer <accessToken>

__Пример запроса:__

```
GET /api/rooms?capacity=6&has_projector=true&floor=2
```

__Параметры запроса:__

 | Параметр      | Тип     | Обязательный/необязательный | Описание                                |
 | ------------- | ------- | --------------------------- | --------------------------------------- |
 | capacity      | integer | необязательный              | Минимальная вместимость переговорной   |
 | has_projector | boolean | необязательный              | Наличие проектора                       |
 | floor         | integer | необязательный              | Этаж, на котором находится переговорная |

### __Ответы:__ 

#### 1. 200 OK 

Тело ответа: 

```
[
  {
    "roomID": 2,
    "roomName": "Blue",
    "capacity": 6,
    "has_projector": true,
    "floor": 2 
  }
  {
    "roomID": 7,
    "roomName": "Green",
    "capacity": 7,
    "has_projector": true,
    "floor": 2 
  }
]
``` 
__Параметры ответа:__

| Параметр | Тип     | Описание                           |
| -------- | ------- | ---------------------------------- |
| roomID   | integer | Идентификатор переговорной комнаты |
| roomName | string  | Название переговорной комнаты      |

#### 2. 401 Unauthorized 

Ошибка выдается в случае, если accessToken недействителен или его нет.

Тело ответа: 

```
{
  "message": "Unauthorized: Access token is missing or invalid"
}
```

#### 2. 403 Forbidden 

Ошибка выдается в случае, если пользователь не имеет прав для выполнения действия.

Тело ответа: 

```
{
  "message": "You do not have permission to perform this action"
}
```

## 3.3 Получение списка своих бронирований
Метод возвращает список бронирований пользователя.

__Метод:__ GET <br>
__URL:__ api/bookings/my <br>
__Content-Type:__ application/json <br>
Authorization: Bearer <accessToken>

__Пример запроса:__

```
GET /api/bookings/my?status=active&start_date=2026-02-01&end_date=2026-02-28
```
__Параметры запросы:__

 | Параметр   | Тип                 | Обязательный/необязательный | Описание                                      |
 | ---------- | ------------------- | --------------------------- | --------------------------------------------- |
 | status     | string              | необязательный              | Статус бронирования (active/cancelled)        |
 | start_date | string (YYYY-MM-DD) | необязательный              | Начальная дата для фильтра по периоду времени |
 | end_date   | string (YYYY-MM-DD) | необязательный              | Конечная дата для фильтра по периоду времени  |




### __Ответы:__ 

#### 1. 200 OK 

Тело ответа: 

```

 [
    {
      "bookingiD": 101,
      "room": {
        "roomID": 3,
        "roomName": "Red",
        "floor": 1
      },
      "start_time": "2026-02-07T10:00:00",
      "end_time": "2026-02-07T11:00:00",
      "status": "active",
      "created_at": "2026-02-05T09:30:00"
    },
    {
      "bookingID": 102,
      "room": {
        "roomID": 1,
        "roomName": "Yellow",
        "floor": 1
      },
      "start_time": "2026-02-08T14:00:00",
      "end_time": "2026-02-08T15:30:00",
      "status": "active",
      "created_at": "2026-02-06T12:00:00"
    }
  ]
``` 
Параметры ответа:
| Параметр   | Тип               | Описание                                                                                     |
| ---------- | ----------------- | -------------------------------------------------------------------------------------------- |
| bookingID  | integer           | Идентификатор бронирования                                                                   |
| start_time | string (datetime) | Дата и время старта бронирования. (Формат ISO 8601). Значение start_time не может быть больше значения end_time |
| end_time   | string (datetime) | Дата и время окончания бронирования (Формат ISO 8601)                                                        |
| created_at | string (datetime) | Дата и время создания бронирования (Формат ISO 8601)                                                           |



#### 2. Ошибки 401, 403 - аналогичны п. 3.2


## 3.4 Создание бронирования переговорной комнаты 
Метод позволяет пользователю забронировать переговорную комнату на определенное время. Система проверяет доступность комнаты в указанном временном интервале и создаёт бронирование, если слот свободен.

__Метод:__ POST <br>
__URL:__ api/bookings <br>
__Content-Type:__ application/json <br>
Authorization: Bearer <accessToken>

__Тело запроса:__

```
{
    "roomID": 2,
    "start_time": "2026-02-10T10:00:00",
    "end_time": "2026-02-10T12:00:00"
}
```

 Параметр | Тип | Обязательный/необязательный | Описание  
---|---|---|---
 roomID | integer | обязательный  | Идентификатор переговорной комнаты 
 start_time | string (datetime) | обязательный  | Время старта бронирования (Формат ISO 8601) 
 end_time | string (datetime) | обязательный  | Время окончания бронирования (Формат ISO 8601) 
                                


### __Ответы:__ 

#### 1. 201 Created 

Тело ответа: 

```
{
    {
  "bookingID": 333,
  "room": {
    "roomID": 2,
    "roomName": "Blue",
    "capacity": 6,
    "has_projector": true,
    "floor": 2 
  },
  "userID": 101,
  "start_time": "2026-02-10T10:00:00",
  "end_time": "2026-02-10T12:00:00",
  "status:" "active",
  "created_at": "2026-02-07T15:00:00"
    }
}
```
#### 2. 400 Bad Request 

Ошибка выдается в случае, если задан неверный формат времени или start_time ≥ end_time.

Тело ответа: 

```
{
"message": "Bad Request: Invalid start_time or end_time."
}
```

#### 3. 409 Conflict 

Ошибка выдается, если временной слот для бронируемой переговорной комнаты уже занят.

Тело ответа:

```
{
"message": "Conflict: The room is already booked for the selected time."
}
```

#### 4. Ошибки 401, 403 - аналогичны п. 3.2

## 3.5 Изменение времени бронирования  

Метод позволяет изменить время старта и время окончания бронирования.

__Метод:__ PUT <br>
__URL:__ api/bookings/{id} <br>
__Content-Type:__ application/json <br>
Authorization: Bearer <accessToken>

__Тело запроса:__

```
{
"start_time": "2026-02-10T12:00:00",
"end_time": "2026-02-10T14:00:00"
}
```
Параметр | Тип | Обязательный/необязательный | Описание  
---|---|---|---
 start_time | string (datetime) | обязательный  | Новое время старта бронирования (Формат ISO 8601) 
 end_time | string (datetime) | обязательный  | Новое время окончания бронирования (Формат ISO 8601) 



### __Ответы:__ 

#### 1. 200 OK 

Тело ответа: 

```
{
     {
"bookingID": 333,
"roomID": 2,  
"start_time": "2026-02-10T12:00:00",
"end_time": "2026-02-10T14:00:00",
"status": "active",
"changed_at":"2026-02-07T16:00:00"
    }
}
```

#### 2. 404 Not Found 

Ошибка выдается, в случае если бронирования с таким значением bookingID не существует. 

```
{
"Not Found: Booking not found."
}
```
#### 3. Ошибки 401, 403 - аналогичны п. 3.2. Ошибки 400, 409 аналогичны п. 3.4

## 3.6  Отмена бронирования  

Метод позволяет отменить существующее бронирование. Пользователь может отменить только своё бронирование. При отмене бронирования его статус меняется на canceled.

__Метод:__ DELETE <br>
__URL:__ api/bookings/{id} <br>
__Content-Type:__ application/json <br>
Authorization: Bearer <accessToken>

__Пример запроса:__

```

    DELETE /api/bookings/105

```
 Параметр | Тип | Обязательный/необязательный | Описание  
---|---|---|---
 bookingID | integer | обязательный  | Идентификатор бронирования


### __Ответы:__ 

#### 1. 200 OK 

Тело ответа: 

```
{
  "message": "Booking has been successfully canceled."
}
```

#### 2. 409 Conflict 

Ошибка выдается, если бронирование уже началось. В таком случае его нельзя отменить 

```
{
  "message": "Conflict: Booking cannot be canceled."
}
```

#### 3. Ошибки 401, 403 - аналогичны п. 3.2. Ошибка 404 аналогична п. 3.5
